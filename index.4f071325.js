function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function r(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){var n;n=t[r],r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n})}return e}function t(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(r,t){if(r){if("string"==typeof r)return e(r,void 0);var n=Object.prototype.toString.call(r).slice(8,-1);if("Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(r,void 0)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n,o,i=function(){var e;function t(){!function(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,t),this.numeric=.9>Math.random()?2:4,this.coords=this.findPlase(),this.oldCoords=r({},this.coords),this.canMuve=!0,this.tile=this.addTile(),this.moved=!1,this.combined=!1,t.tiles.push(this)}return e=[{key:"findPlase",value:function(){for(var e=[],r=0;r<t.FIELD_ROWS.length;r++)for(var n=t.FIELD_ROWS[r].children,o=0;o<n.length;o++)n[o].firstChild||e.push({r:r,c:o});if(0===e.length)return!1;var i=e.length-1;return e[Math.floor(Math.random()*(i+1))]}},{key:"addTile",value:function(){var e=this.coords,r=e.r,n=e.c,o=t.FIELD_ROWS[r].children[n];return o.insertAdjacentHTML("beforeend",'\n      <div class="cell cell--'.concat(this.numeric,'">').concat(this.numeric,"</div>\n    ")),o.children[0]}},{key:"checkMoveLeft",value:function(){if(0===this.coords.c)return!1;var e=this.findNeighbourL();return this.checkNeighbour(e)}},{key:"checkMoveRight",value:function(){if(3===this.coords.c)return!1;var e=this.findNeighbourR();return this.checkNeighbour(e)}},{key:"checkMoveTop",value:function(){if(0===this.coords.r)return!1;var e=this.findNeighbourU();return this.checkNeighbour(e)}},{key:"checkMoveBottomn",value:function(){if(3===this.coords.r)return!1;var e=this.findNeighbourB();return this.checkNeighbour(e)}},{key:"checkNeighbour",value:function(e){return!e||e.numeric===this.numeric&&!e.combined&&!this.combined}},{key:"findNeighbourU",value:function(){var e=this.coords,r=e.r,n=e.c;return t.tiles.find(function(e){return e.coords.c===n&&e.coords.r===r-1})}},{key:"findNeighbourB",value:function(){var e=this.coords,r=e.r,n=e.c;return t.tiles.find(function(e){return e.coords.c===n&&e.coords.r===r+1})}},{key:"findNeighbourR",value:function(){var e=this.coords,r=e.r,n=e.c;return t.tiles.find(function(e){return e.coords.r===r&&e.coords.c===n+1})}},{key:"findNeighbourL",value:function(){var e=this.coords,r=e.r,n=e.c;return t.tiles.find(function(e){return e.coords.r===r&&e.coords.c===n-1})}}],function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();i.FIELD_ROWS=document.querySelectorAll(".field-row"),i.tiles=[];var c=0,u=[],a=document.querySelector(".start"),s=document.querySelector(".restart"),l=document.querySelector(".message-win"),f=document.querySelector(".message-start"),d=document.querySelector(".message-lose");function h(e){document.querySelector(".game-score").innerHTML=e}function v(){u.forEach(function(e){if(e.moved){var t=e.oldCoords,o=t.r,c=t.c;e.tile=e.addTile(),e.combined&&(e.tile.classList.add("combin"),e.combined=!1),i.FIELD_ROWS[o].children[c].innerHTML="",e.moved=!1,e.oldCoords=r({},e.coords),n=null}})}function m(e,r,t){if(e){var n=i.tiles.indexOf(e);e.tile.parentNode.innerHTML="",i.tiles.splice(n,1),e.moved=!1,t.numeric*=2,t.combined=!0,c+=t.numeric,t.numeric>=2042&&l.classList.remove("hidden")}switch(r){case"ArrowUp":t.coords.r-=1;break;case"ArrowLeft":t.coords.c-=1;break;case"ArrowDown":t.coords.r+=1;break;case"ArrowRight":t.coords.c+=1}return t}function y(){return setTimeout(function(){b()},150)}function b(){new i().tile.classList.add("born"),o=null}a.addEventListener("click",function(){s.classList.remove("hidden"),a.classList.add("hidden"),f.classList.add("hidden"),y(),y()}),s.addEventListener("click",function(){l.classList.add("hidden"),d.classList.add("hidden"),document.querySelectorAll(".cell").forEach(function(e){e.parentNode.innerHTML=""}),document.querySelector(".game-field").style.opacity="1",i.tiles=[],c=0,h(""),y(),y()}),document.addEventListener("keydown",function(e){var r=function(r){var n=[];if("ArrowUp"===e.key){for(var o,c=function(r){i.tiles.filter(function(e){return e.coords.r===r}).forEach(function(r){if(r.checkMoveTop()){var t=r.findNeighbourU();n.push(m(t,e.key,r))}})},a=1;a<4;a++)c(a);if(0===n.length)return"break";n.forEach(function(e){e.tile.style.transform="translateY(calc(-".concat(100*r,"% - ").concat(10*r,"px))"),e.moved=!0}),(o=u).push.apply(o,t(n))}if("ArrowLeft"===e.key){for(var s,l=function(r){i.tiles.filter(function(e){return e.coords.c===r}).forEach(function(r){if(r.checkMoveLeft()){var t=r.findNeighbourL();n.push(m(t,e.key,r))}})},f=1;f<4;f++)l(f);if(0===n.length)return"break";n.forEach(function(e){e.tile.style.transform="translateX(calc(-".concat(100*r,"% - ").concat(10*r,"px))"),e.moved=!0}),(s=u).push.apply(s,t(n))}if("ArrowDown"===e.key){for(var d,h=function(r){i.tiles.filter(function(e){return e.coords.r===r}).forEach(function(r){if(r.checkMoveBottomn()){var t=r.findNeighbourB();n.push(m(t,e.key,r))}})},v=2;v>=0;v--)h(v);if(0===n.length)return"break";n.forEach(function(e){e.tile.style.transform="translateY(calc(".concat(100*r,"% + ").concat(10*r,"px))"),e.moved=!0}),(d=u).push.apply(d,t(n))}if("ArrowRight"===e.key){for(var y,b=function(r){i.tiles.filter(function(e){return e.coords.c===r}).forEach(function(r){if(r.checkMoveRight()){var t=r.findNeighbourR();n.push(m(t,e.key,r))}})},p=2;p>=0;p--)b(p);if(0===n.length)return"break";n.forEach(function(e){e.tile.style.transform="translateX(calc(".concat(100*r,"% + ").concat(10*r,"px))"),e.moved=!0}),(y=u).push.apply(y,t(n))}};n&&(clearTimeout(n),v(u)),o&&(clearTimeout(o),b()),u=[];for(var a=1;a<4&&"break"!==r(a);a++);u.length>0&&(n=setTimeout(function(){v()},100),h(c),o=y()),i.tiles.some(function(e){return e.checkMoveTop()||e.checkMoveBottomn()||e.checkMoveLeft()||e.checkMoveRight()})||(document.querySelector(".game-field").style.opacity="0.5",d.classList.remove("hidden"))});
//# sourceMappingURL=index.4f071325.js.map
